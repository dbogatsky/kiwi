<div class="panel panel-dark panel-alt">
  <div class="panel-heading">
    <h3 class="panel-title">Meetings Map</h3>
  </div>
  <div class="panel-body">
    <p>See your schedule today on the map below</p>
    <div id="gmap-marker" style="height: 300px"></div>
  </div><!-- panel-body -->
</div>
<script type="text/javascript">
  
  <% if !request.location.nil? && !request.location.nil? %>
    var latitude = '<%=request.location.latitude%>';
    var longitude = '<%=request.location.longitude%>';
    var minZoomLevel = 1;
    var map_marker = new GMaps({
      div: '#gmap-marker',
      lat: latitude,
      lng: longitude,
      zoom: minZoomLevel
    });
  <% else %>
      var map_marker = new GMaps({
      div: '#gmap-marker',
      zoom: 1
    });
  <% end %>

  <%if @meetings.present? && @meetings.count > 0%>
    <%@meetings.each do |meeting|%>
      <% if !meeting.latitude.nil? && !meeting.longitude.nil? %>
        var latitude = '<%= meeting.latitude %>'; 
        var longitude = '<%= meeting.longitude %>';
        var title = '<%= meeting.title %>';
        var address = '<%= meeting.location %>'

        map_marker.addMarker({
          lat: latitude,
          lng: longitude,
          label: title,
          click: function(e) {
            alert(address);
          }
        });
      <% end %>
    <% end %>
  <%end%>
</script>