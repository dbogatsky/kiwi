<!--Shared javascript -->
<script src="/assets/bootstrap/js/jquery-1.11.1.min.js"></script>
<script src="/assets/bootstrap/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/assets/bootstrap/js/jquery-ui-1.10.3.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
<script src="/assets/bootstrap/js/modernizr.min.js"></script>
<script src="/assets/bootstrap/js/jquery.sparkline.min.js"></script>
<script src="/assets/bootstrap/js/toggles.min.js"></script>
<!-- <script src="/assets/bootstrap/js/retina.min.js"></script> -->

<script src="/assets/bootstrap/js/morris.min.js"></script>
<script src="/assets/bootstrap/js/raphael-2.1.0.min.js"></script>
<script src="/assets/bootstrap/js/jquery.datatables.min.js"></script>


<!--<script src="http://maps.google.com/maps/api/js?sensor=true"></script>-->
<!-- <script src="http://maps.google.com/maps/api/js"></script> -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
<script src="/assets/bootstrap/js/gmaps.js"></script>


<!--TEST all included javascripts -->
<script src="/assets/bootstrap/js/holder.js"></script>

<!-- Form elements - status and date picker -->
<script src="/assets/vertical-timeline/js/main.js"></script>
<script src="/assets/bootstrap/js/bootstrap-timepicker.min.js"></script>
<script src="/assets/bootstrap/js/jquery.maskedinput.min.js"></script>
<script src="/assets/bootstrap/js/jquery.tagsinput.min.js"></script>
<script src="/assets/bootstrap/js/jquery.mousewheel.js"></script>
<script src="/assets/bootstrap/js/select2.min.js"></script>
<script src="/assets/bootstrap/js/jquery.validate.min.js"></script>
<!-- <script src="assets/bootstrap/js/additional-methods.min.js"></script> -->
<script src="/assets/bootstrap/js/bootstrap-editable.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap-datetimepicker.min.js"></script>
<script src="/assets/bootstrap/js/moment.min.js"></script>
<script src="/assets/bootstrap/js/jquery.cookies.js"></script>
<script src="/assets/bootstrap/js/jquery.autogrow-textarea.js"></script>
<script src="/assets/bootstrap/js/cropper.min.js"></script>
<script src="/assets/bootstrap/js/jquery.gritter.min.js"></script>
<script src="/assets/bootstrap/js/bootstrap-wizard.min.js"></script>
<script src="/assets/scripts/wyshtml5/wyshtml5.js"></script>
<script src="/assets/scripts/wyshtml5/bootstrap-wysihtml5.js"></script>
<script src="/assets/bootstrap/js/fullcalendar.min.js"></script>
<script src="/assets/bootstrap/js/jquery.ui.touch-punch.min.js"></script>
<script src="/assets/bootstrap/js/jquery.confirm.js"></script>
<!-- end test -->

<script src="/assets/bootstrap/js/custom.js"></script>
<!-- <script src="/assets/scripts/gmap.js"></script> -->



<script>
$(document).ready(function() {
  function address_auto_fill(e){
    var componentForm = {
      street_number: 'short_name',
      route: 'long_name',
      locality: 'long_name',
      administrative_area_level_1: 'long_name',
      country: 'short_name',
      postal_code: 'short_name'
    };
    var autocomplete = new google.maps.places.Autocomplete(e);
    autocomplete.addListener('place_changed', fillInAddress);

    function fillInAddress() {
      var place = autocomplete.getPlace();
      if (e.id == 'account_name'){
        $("#account_name").val(place.name)
      }
      var lat = place.geometry.location.lat();
      var lng = place.geometry.location.lng();

      $("#account_lat").val(lat);
      $("#account_lng").val(lng);

      for (var component in componentForm) {
        if (component != 'route'){
          $('#'+component).val('');
          $('#'+component).attr('readonly', false)
        }
      }

      for (var i = 0; i < place.address_components.length; i++) {
        var addressType = place.address_components[i].types[0];
        if (componentForm[addressType]) {
          var val = place.address_components[i][componentForm[addressType]];
          if (addressType !='route'){
            if (addressType == 'country'){
              $("#country").select2().val(val);
              $("#country").select2().val();

            }else if (addressType == 'street_number'){
              r = place.address_components[1][componentForm['route']]
              document.getElementById(addressType).value = val+' '+r
            }else{
              document.getElementById(addressType).value = val;
            }
          }
        }
      }
    }
  }

  jQuery(function($) {
    $('#schedule-from-datepicker').on('change', function() {
        $('#schedule-to-datepicker').prop('min', $(this).val());
        $('#schedule-to-datepicker').val($(this).val());
    });
  });
    if (document.getElementById("account_name") != null){
        address_auto_fill(document.getElementById("account_name"));
      }else{
        address_auto_fill(document.getElementById("street_number"));
    }

    $('body').bind('ajax:beforeSend', function(event, xhr, settings) {
      console.log("ajax-beforesend");
      $("#preloader").show();
    });

    $('body').bind('ajax:complete', function(xhr, status) {
      console.log("ajax-complete");
      $("#preloader").hide();
    });

    $('.datepicker').datepicker();

    // $('#schedule-from-datepicker, #meeting-reminder-date').datepicker({
    //   dateFormat: 'mm/dd/yy',
    //   altField: "#schedule-to-datepicker",
    //   altFormat: "mm/dd/yy",
    //   onSelect: function (selected) {
    //     var dt = new Date(selected);
    //     dt.setDate(dt.getDate());
    //     $("#schedule-to-datepicker").datepicker("option", "minDate", dt);
    //   }
    // });
    // $('#schedule-to-datepicker').datepicker({
    //   dateFormat: 'mm/dd/yy'
    // });

    var d = new Date();
    var hh = d.getHours();
    var m = d.getMinutes();
    var dd = 'AM';
    var h = hh;
    if (h >= 12) {
        h = hh-12;
        dd = "PM";
    }
    if (h == 0) {
        h = 12;
    }
    m = m<10?"0"+m:m;
    var current_time = h+":"+m+" "+dd;

    $('#schedule-from-timepicker').timepicker({
      minuteStep: 15,
      defaultTime: current_time
    });

    $('#schedule-to-timepicker').timepicker({
      minuteStep: 15
    });
    $('#scheduleFromTimePicker').timepicker().on('hide.timepicker', function(e) {
      $('#schedule-to-timepicker').timepicker('setTime', e.time.value);
    });

    $(".account_next").click(function(){
       address_auto_fill(document.getElementById("street_number"));
    });
  });

</script>
<!-- end of shared javascript -->